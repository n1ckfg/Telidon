<!DOCTYPE html>
<html>
	
	<head>
		<script src="../../../js/libraries/p5js/p5.min.js"></script>
		<script src="../../../js/libraries/p5js/p5.svg.js"></script>
		<script src="../../../js/telidon/naplps.js"></script>
	</head>

	<body>
		<script>
			"use strict";

			let pg, ps, paths, points;

			function preload() {
				ps = loadSVG("test.svg");
			}

			function setup() {
				createCanvas(400, 400);
				pg = createGraphics(400, 400, SVG);
				pg.push();
				pg.image(ps, 0, 0, pg.width, pg.height);
			    pg.pop();
			    paths = pg.querySVG('polygon');

			    points = [];
			    for (let path of paths) {
			    	let pointsRaw = path.attribute("points").split(" ");
			    	for (let pointRaw of pointsRaw) {
			    		let pointRawArray = pointRaw.split(",");
			    		let point = createVector(float(pointRawArray[0])/10, float(pointRawArray[1])/10);
			    		points.push(point);
			    	}
			    }

				let input = [];

				const color1 = new Vector3(224, 224, 224);
				const color2 = new Vector3(252, 0, 144);		

				let points1 = [];
				points1.push(new Vector2(0.32763671875, 0.64599609375));
				points1.push(new Vector2(0.39013671875, 0.33203125));
				points1.push(new Vector2(0.05126953125, 0.31103515625));
				points1.push(new Vector2(0.05859375, 0.2783203125));
				points1.push(new Vector2(0.4033203125, 0.26513671875));

				
				let points2 = [];
				points2.push(new Vector2(0.263671875, 0.4091796875));
				points2.push(new Vector2(0.333984375, 0.1767578125));
				points2.push(new Vector2(0.41357421875, 0.17041015625));

				let points3 = [];
				points3.push(new Vector2(0.44970703125, 0.54296875));
				points3.push(new Vector2(0.65966796875, 0.53955078125));
				points3.push(new Vector2(0.5693359375, 0.60205078125));

				const isFill1 = false;
				const isFill2 = false;
				const isFill3 = false;

				const stroke1 = new NapInputWrapper(color1, points1, isFill1);
				const stroke2 = new NapInputWrapper(color1, points2, isFill2);
				const stroke3 = new NapInputWrapper(color2, points3, isFill3);
				
				input.push(stroke1);
				input.push(stroke2);
				input.push(stroke3);

				const encoder = new NapEncoder(input);

				document.body.appendChild(document.createElement("br"));
				document.body.appendChild(document.createElement("br"));
				const div = document.createElement("div");
				document.body.appendChild(div);
				div.innerHTML = encoder.napRaw;				
			}

			function draw() {
				background(127);
				beginShape();
				for (let point of points) {
					vertex(point.x, point.y);
				}
				endShape();
			}
		</script>
	</body>

</html>